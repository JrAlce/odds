<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparativo de Odds - Painel Completo</title>

<!-- Bibliotecas -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
  body {
    font-family: "Segoe UI", sans-serif;
    background-color: #f4f6fa;
    margin: 0;
    padding: 20px;
  }

  .container {
    max-width: 1150px;
    margin: auto;
    background: white;
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }

  header {
    background: linear-gradient(90deg, #004aad, #0072ff);
    color: white;
    padding: 16px 24px;
    text-align: center;
    font-size: 1.4em;
    font-weight: bold;
  }

  .info {
    display: flex;
    justify-content: space-around;
    background-color: #eaf1fb;
    padding: 12px;
    border-bottom: 2px solid #d4e1fa;
    flex-wrap: wrap;
  }

  .info input {
    border: none;
    background: none;
    border-bottom: 1px solid #aaa;
    padding: 4px;
    font-size: 1em;
    text-align: center;
    width: 200px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
  }

  th {
    background-color: #004aad;
    color: white;
    padding: 10px;
    font-weight: 600;
  }

  td {
    border-bottom: 1px solid #e0e0e0;
    padding: 8px;
  }

  tr:hover {
    background-color: #f7faff;
  }

  input.odds {
    width: 80px;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 4px;
  }

  .difference { background-color: #ffe8cc; }
  .profit { background-color: #d7fcd7; }

  .actions {
    display: flex;
    justify-content: center;
    gap: 12px;
    padding: 14px;
    background-color: #f9f9f9;
    border-top: 2px solid #eee;
    flex-wrap: wrap;
  }

  button {
    background: linear-gradient(90deg, #0072ff, #00c6ff);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 0.95em;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }

  button:hover {
    transform: scale(1.05);
    box-shadow: 0 0 10px rgba(0,114,255,0.3);
  }

  button.reset {
    background: linear-gradient(90deg, #ff4d4d, #ff1a1a);
  }

  #chartContainer {
    padding: 20px;
    background: #f9fbff;
    border-top: 2px solid #e3e8f0;
  }

  footer {
    background-color: #004aad;
    color: white;
    text-align: center;
    padding: 8px;
    font-size: 0.9em;
  }

  canvas {
    max-width: 100%;
    height: 400px !important;
  }
</style>
</head>
<body>

<div class="container" id="exportArea">
  <header>Comparativo de Odds</header>

  <div class="info">
    <div>Evento: <input type="text" id="evento" value="Flamengo x SÃ£o Paulo"></div>
    <div>CompetiÃ§Ã£o: <input type="text" id="competicao" value="BrasileirÃ£o SÃ©rie A"></div>
    <div>Tempo: <input type="text" id="tempo" value="15 Minutos de Partida"></div>
  </div>

  <table id="oddsTable">
    <thead>
      <tr>
        <th>Mercado</th>
        <th>Betsul</th>
        <th>Bet365</th>
        <th>Betano</th>
        <th>DiferenÃ§a</th>
        <th>Rentabilidade</th>
      </tr>
    </thead>
    <tbody>
      <tr><td colspan="6" style="background:#e7f0ff;font-weight:600;">Vencedor do Jogo</td></tr>
      <tr><td>1</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>
      <tr><td>X</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>
      <tr><td>2</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>

      <tr><td colspan="6" style="background:#fff5e5;font-weight:600;">Total de Gols (+)</td></tr>
      <tr><td>Mais de 2.5</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>

      <tr><td colspan="6" style="background:#e9f7e9;font-weight:600;">Total de Gols (-)</td></tr>
      <tr><td>Menos de 2.5</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>

      <tr><td colspan="6" style="background:#f0ecff;font-weight:600;">Ambas Marcam</td></tr>
      <tr><td>Sim</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>
      <tr><td>NÃ£o</td><td><input class="odds"></td><td><input class="odds"></td><td><input class="odds"></td><td class="difference">0</td><td class="profit">0%</td></tr>
    </tbody>
  </table>

  <div id="chartContainer">
    <canvas id="oddsChart"></canvas>
  </div>
</div>

<div class="actions">
  <button onclick="salvarDados()">ðŸ’¾ Salvar</button>
  <button onclick="carregarDados()">ðŸ“‚ Carregar</button>
  <button onclick="gerarPDF()">ðŸ“Š Exportar PDF</button>
  <button class="reset" onclick="resetar()">ðŸ§¹ Limpar</button>
</div>

<footer>Desenvolvido para anÃ¡lise comparativa de odds âš½</footer>

<script>
  const inputs = document.querySelectorAll(".odds, .info input");
  let chart;

  function atualizar() {
    const linhas = document.querySelectorAll("#oddsTable tbody tr");
    const mercados = [];
    const betsul = [], bet365 = [], betano = [];

    linhas.forEach(linha => {
      const cels = linha.querySelectorAll("td input.odds");
      if (cels.length === 3) {
        const mercado = linha.children[0].textContent.trim();
        const [b1, b2, b3] = Array.from(cels).map(c => parseFloat(c.value) || 0);
        const diffCell = linha.querySelector(".difference");
        const profitCell = linha.querySelector(".profit");
        const max = Math.max(b1, b2, b3);
        const min = Math.min(b1 || Infinity, b2 || Infinity, b3 || Infinity);
        const diff = (max - min).toFixed(2);
        const rent = min > 0 ? (((max - min) / min) * 100).toFixed(1) + "%" : "0%";

        diffCell.textContent = diff;
        profitCell.textContent = rent;

        mercados.push(mercado);
        betsul.push(b1);
        bet365.push(b2);
        betano.push(b3);
      }
    });
    atualizarGrafico(mercados, betsul, bet365, betano);
  }

  function atualizarGrafico(labels, betsul, bet365, betano) {
    const ctx = document.getElementById('oddsChart').getContext('2d');
    if (chart) chart.destroy();
    chart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels,
        datasets: [
          { label: 'Betsul', data: betsul, backgroundColor: '#0072ff' },
          { label: 'Bet365', data: bet365, backgroundColor: '#00b050' },
          { label: 'Betano', data: betano, backgroundColor: '#ff9900' }
        ]
      },
      options: {
        responsive: true,
        scales: { y: { beginAtZero: true, title: { display: true, text: 'Odds' } } },
        plugins: {
          legend: { position: 'bottom' },
          title: { display: true, text: 'Comparativo Visual das Odds por Mercado' }
        }
      }
    });
  }

  function salvarDados() {
    const dados = {
      evento: evento.value,
      competicao: competicao.value,
      tempo: tempo.value,
      odds: Array.from(document.querySelectorAll(".odds")).map(o => o.value)
    };
    localStorage.setItem("comparativoOdds", JSON.stringify(dados));
    alert("âœ… Dados salvos!");
  }

  function carregarDados() {
    const dados = JSON.parse(localStorage.getItem("comparativoOdds"));
    if (!dados) return alert("Nenhum dado salvo!");
    evento.value = dados.evento;
    competicao.value = dados.competicao;
    tempo.value = dados.tempo;
    document.querySelectorAll(".odds").forEach((o, i) => o.value = dados.odds[i] || "");
    atualizar();
    alert("ðŸ“‚ Dados carregados!");
  }

  async function gerarPDF() {
    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF('p', 'pt', 'a4');
    const area = document.getElementById("exportArea");

    const canvas = await html2canvas(area, { scale: 2 });
    const imgData = canvas.toDataURL("image/png");

    const pageWidth = pdf.internal.pageSize.getWidth();
    const imgHeight = (canvas.height * pageWidth) / canvas.width;
    pdf.addImage(imgData, "PNG", 0, 0, pageWidth, imgHeight);

    pdf.save(`Comparativo_Odds_${evento.value.replace(/\s+/g, "_")}.pdf`);
  }

  function resetar() {
    if (!confirm("Tem certeza que deseja limpar tudo?")) return;
    document.querySelectorAll(".odds").forEach(o => o.value = "");
    localStorage.removeItem("comparativoOdds");
    atualizar();
  }

  inputs.forEach(i => i.addEventListener("input", atualizar));
</script>

</body>
</html>